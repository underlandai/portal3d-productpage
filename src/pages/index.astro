---
import Layout from '~/layouts/PageLayout.astro';
import Image from '~/components/common/Image.astro';

import Hero from '~/components/widgets/Hero.astro';
import Features from '~/components/widgets/Features.astro';
import Steps from '~/components/widgets/Steps.astro';
import FAQs from '~/components/widgets/FAQs.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';

import modelDemo3Image from '~/assets/images/Cloud-Model-Screenshot-2025-09-10-rev.3.png';
import drillHolesImage from '~/assets/images/underland drill holes image-Photoroom.png';

const metadata = {
  title: 'Underland Portal3D - Reality-driven 3D for Mining Data',
  description: 'Reality-driven 3D for Mining Data. Powerful web-based 3D visualisation platform for subsurface mining data. Upload your OMF models and share them instantly with stakeholders via secure links.',
  canonical: 'https://portal3d.underlandex.com/',
  ignoreTitleTemplate: true,
  robots: {
    index: true,
    follow: true,
  },
  openGraph: {
    title: 'Underland Portal3D - Reality-driven 3D for Mining Data',
    description: 'Reality-driven 3D for Mining Data. Powerful web-based 3D visualisation platform for subsurface mining data. Upload your OMF models and share them instantly.',
    type: 'website',
    url: 'https://portal3d.underlandex.com/',
  }
};
---

<Layout metadata={metadata}>
  <Hero
    actions={[
      {
        variant: 'primary',
        text: 'Upload demo',
        href: 'https://app.underlandex.com',
        target: '_blank',
        rel: 'noopener',
        icon: 'tabler:upload',
      },
      { text: 'Learn More', href: '#features' },
    ]}
  >
    <Fragment slot="title">
      <div class="flex flex-col items-center mb-4 group" style="overflow: visible;">
        <a href="https://app.underlandex.com" rel="noopener" target="_blank" style="overflow: visible; display: block;">
          <Image
            id="coresync-logo"
            src="~/assets/images/coresync-circlev1-transparent.svg"
            alt="portal3d.underlandex.com Logo"
            class="w-32 h-32 sm:w-40 sm:h-40 md:w-48 md:h-48 mb-2 sm:mb-4 cursor-pointer ios-svg-fix"
            width={192}
            height={192}
          />
        </a>

        <!-- iOS Safari SVG Fix -->
        <style>
          /* Ensure SVG animations work on iOS Safari */
          #coresync-logo {
            will-change: transform;
            -webkit-transform-style: preserve-3d;
            transform-style: preserve-3d;
            overflow: visible !important;
          }

          /* Fix Safari horizontal crop during rotation */
          #coresync-logo img,
          #coresync-logo svg {
            overflow: visible !important;
            -webkit-transform-origin: center center;
            transform-origin: center center;
          }

          /* Ensure parent link doesn't clip */
          #coresync-logo {
            display: block;
            overflow: visible !important;
          }

          /* iOS Safari specific SVG container fix - only on mobile */
          @media (max-width: 767px) {
            .ios-svg-fix {
              -webkit-transform: translateZ(0);
              transform: translateZ(0);
              -webkit-backface-visibility: hidden;
              backface-visibility: hidden;
              width: 130px !important;
              height: 130px !important;
              max-width: 100%;
              max-height: 100%;
              overflow: visible !important;
            }
          }
        </style>

        <script>
          // (Your existing script remains unchanged)
          const logo = document.getElementById('coresync-logo');
          if (logo) {
            window.addEventListener('DOMContentLoaded', () => {
              logo.classList.add('animate-spin-once');
              setTimeout(() => {
                logo.classList.remove('animate-spin-once');
              }, 2000);
            });
            logo.addEventListener('mouseenter', () => {
              if (!logo.classList.contains('animate-spin-once')) {
                logo.classList.add('animate-spin-slow');
              }
            });
            logo.addEventListener('mouseleave', () => {
              logo.addEventListener('animationiteration', () => {
                logo.classList.remove('animate-spin-slow');
              }, {once: true});
            });
          }
        </script>
        <span class="text-black dark:text-white highlight tracking-wide text-5xl sm:text-7xl md:text-7xl leading-tight" style="font-family: 'Raleway', sans-serif; font-weight: 200;">Underland Portal3D
        </span>
      </div>
    </Fragment>

    
    <Fragment slot="subtitle">
      Reality-driven 3D for Mining Data
    </Fragment>

    <Fragment slot="image">
      <div class="relative w-full" style="max-height: 85vh;">
        <Image
          src={drillHolesImage}
          alt="Underland Portal3D - 3D Drill Holes Visualization"
          class="w-full h-full object-contain rounded-md"
          style="max-height: 85vh;"
          loading="eager"
          widths={[400, 768, 1024, 1536, 2048]}
          sizes="(max-width: 768px) 100vw, (max-width: 1024px) 100vw, 100vw"
        />
      </div>
    </Fragment>
  </Hero>


  <Features
    id="features"
    tagline="Key Capabilities"
    title="3D Mining Models? View and Share Faster"
    subtitle="Portal3D provides a secure, web-based platform for viewing and sharing 3D resource project data."
    items={[
      {
        title: 'High-Performance Visualisation',
        description: 'Explore subsurface project information directly in your web browser. Our AWS High-Performance Computing (HPC) backend ensures a fluid, interactive 3D experience, removing the dependency on specialised software or powerful local workstations.',
        icon: 'tabler:device-imac-bolt',
      },
      {
        title: 'Instant Collaboration',
        description: 'Securely share your 3D model and mining data with stakeholders instantly via a unique URL link.',
        icon: 'tabler:share',
      },
      {
        title: 'Total Data Control',
        description: 'Maintain complete data sovereignty with secure hosting on AWS. Enterprise clients have the option of a fully self-hosted solution.',
        icon: 'tabler:shield-lock',
      },
      {
        title: 'Broad Compatibility',
        description: 'Underland Portal3D integrates with your existing software workflows. Export your project data with ease from leading packages such as Leapfrog, Deswik, Mira Geoscience, Maptek Vulcan, Micromine, GEOVIA, and, Datamine.',
        icon: 'tabler:transfer-in',
      },
      {
        title: 'Global Reach, Low Latency',
        description: "By leveraging AWS's global infrastructure, we serve your models from data centres located near your stakeholders, ensuring optimal load times worldwide.",
        icon: 'tabler:world',
      },
      {
        title: 'API Access',
        description: "Integrate Underland Portal3D into your workflows with API access for programmatic control, available on our Enterprise plan.",
        icon: 'tabler:puzzle',
      },
      {
        title: 'Dedicated Support',
        description: "Our team is available to assist with integration, deployment, and scaling to meet your operational requirements.",
        icon: 'tabler:lifebuoy',
      },
    ]}
  />


  <Steps
    title="View Your Subsurface Model in Three Simple Steps"
    items={[
      {
        title: 'Step 1: <span class="font-medium">Export & Upload</span>',
        description:
          "Export your Open Mining Format (OMF) or GeoH5 (partially supported) from your existing mining software and upload the 3D subsurface model through our secure web interface.",
        icon: 'tabler:upload',
      },
      {
        title: 'Step 2: <span class="font-medium">Configure Layers</span>',
        description:
          "Toggle which layers are visible to focus your narrative in settings.",
        icon: 'tabler:user-check',
      },
      {
        title: 'Step 3: <span class="font-medium">Visualise & Share</span>',
        description:
          "Launch visualisation, then copy the unique URL and send it to your stakeholders.",
        icon: 'tabler:world-share',
      },
      {
        title: 'Done!',
        icon: 'tabler:check',
      },
    ]}
  >
    <Fragment slot="image">
      <Image
        src={modelDemo3Image}
        alt="Underland Portal3D Model Visualisation"
        class="inset-0 object-cover w-full rounded-md shadow-lg md:absolute md:h-full"
        loading="lazy"
        widths={[400, 768, 1024, 1536]}
        sizes="(max-width: 768px) 100vw, (max-width: 1024px) 100vw, 50vw"
      />
    </Fragment>
  </Steps>


  <FAQs
    title="Frequently Asked Questions"
    subtitle="Here are some common questions about Underland Portal3D. If you cannot find the information you require, please <a href='/contact' class='text-primary hover:underline'>contact</a> our support team."
    classes={{ container: 'max-w-6xl' }}
    items={[
      {
        title: 'Data Security & Hosting',
        items: [
          {
            title: 'Where is my data stored?',
            description: 'We prioritise your data sovereignty. Your data is never stored on our own servers. All data is hosted on Amazon Web Services (AWS), the worldâ€™s leading cloud platform. This provides robust security, reliability, and allows your data to be stored in specific geographic regions to meet compliance needs.',
          },
          {
            title: 'Who has access to my data?',
            description: 'You maintain full control. Only users you explicitly grant access to can view or interact with your subsurface models via secure, time-limited links and role-based access controls.',
          },
        ],
      },
      {
        title: 'Enterprise & Integration',
        items: [
          {
            title: 'Can we host our own data?',
            description: 'Yes. For organisations with strict data residency or internal governance requirements, our Enterprise plan offers a self-hosted option. You can deploy the Underland Portal3D platform within your own cloud environment, giving you complete control.',
          },
          {
            title: 'Do you provide an API?',
            description: "Yes, our Enterprise plan includes API access. The API allows you to programmatically upload models, manage projects, and embed the 3D viewer directly into your company's internal applications, websites, or data platforms.",
          },
        ],
      },
      {
        title: 'Processing & Performance',
        items: [
          {
            title: 'How long will it take for my subsurface model to be processed?',
            description: "Thanks to our AWS High-Performance Computing (HPC) backend, most subsurface models are ready within a few minutes. However, processing time can occasionally take longer depending on the size and complexity of your data (up to 1TB) and current platform demand. We're constantly optimising our processing pipeline for speed.",
          },
          {
            title: 'Do you support any file formats besides OMF and GeoH5?',
            description: 'Yes! While OMF and GeoH5 (partially supported) are our primary format, we are actively developing support for others. We plan to add support for VTK, GOCAD, CSV, and OBJ files in the future. If you have a specific format need, please ask!',
          },
        ],
      },
      {
        title: 'Getting Started',
        items: [
          {
            title: 'How do I get started?',
            description: 'Visit <a href="https://app.underlandex.com" class="text-primary hover:underline" target="_blank" rel="noopener">Underland Portal3D</a> to create a free account and explore the platform. To unlock sharing, API access, and collaboration features, choose a Professional, Team, or Enterprise plan. For enterprise inquiries, please contact us.',
          },
          {
            title: 'How can I provide feedback?',
            description: 'We value your feedback! Please use the contact us form to share your thoughts, suggestions, and any issues you encounter. Your input is crucial as we continue to develop Underland Portal3D.',
          },
        ],
      },
    ]}
  />


  <CallToAction
    actions={[
      {
        variant: 'primary',
        text: 'Try now (free)',
        href: 'https://app.underlandex.com',
        target: '_blank',
        rel: 'noopener',
        icon: 'tabler:upload',
      },
      {
        variant: 'secondary',
        text: 'Contact us',
        href: '/contact',
        icon: 'tabler:mail',
      },
    ]}
  >
    <Fragment slot="title">
      Ready to show your models?
    </Fragment>

  </CallToAction>
</Layout>